<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Autonomous Flip | Khai Nguyen </title> <meta name="author" content="Khai Nguyen"> <meta name="description" content="CMU 24-774: Advanced Control Systems Integration - Fall 22.&lt;br&gt; ðŸ”„ Drone Acrobatics: Autonomous Flip"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon-1024.png?5302343bab5aea09f0f1ad5592fe9d06"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xkhainguyen.github.io/projects/ACSI_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Khai</span> Nguyen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Autonomous Flip</h1> <p class="post-description">CMU 24-774: Advanced Control Systems Integration - Fall 22.<br> ðŸ”„ Drone Acrobatics: Autonomous Flip</p> </header> <article> <p>This is my project within the course <a href="/assets/acsi/24-774%20Syllabus%20Fall%202022.pdf">24-774: Advanced Control Systems Integration</a> at Carnegie Mellon University in Fall 2022 semester. Some key points:</p> <p>Drone Acrobatics: Autonomous Flip | C/C++, MATLAB/Simulink, Python, Crazyflie | [<a href="/assets/acsi/ACSI_Final_Report.pdf">pdf</a>] [<a href="https://docs.google.com/presentation/d/1BqBP_CZBvUQyLorrP2kWBRFlm1S1ZUIPDmQnaaJl_aE/edit?usp=sharing" rel="external nofollow noopener" target="_blank">slides</a>]</p> <ul> <li>Led a team to derive an autonomous multi-flip pipeline for nano-quadrotors and successfully verified it in simulation.</li> <li>Introduced a new LQR controller onto Crazyflie (C/C++ on STM32); accomplished robust hovering performance.</li> <li>Implemented flip planner, flip controller and re-stabilizing controller; delivered single-flip maneuver with Crazyflie.</li> </ul> <hr> <p><strong>Abstract</strong>â€”Drones are popular due to their ability to take off and land vertically, high maneuverability, and hovering capability. However, they are highly unstable and susceptible to external disturbances. In this project, we examine flip maneuver which exploits the quadrotorâ€™s agility while maintaining stability simultaneously. The flipping pipeline consists of three main modules: trajectory planner, tracking controller and stabilizing controller. A smooth three-stage flipping rate profile is generated in account for the limited sensing and actuating capabilities of the micro quadrotor. A PD controller is used for executing the rapid trajectory for the flip, then switched to a cascaded PID to re-stabilize the quadrotor during normal flight. Beside, a full-state feedback LQR controller is designed to test with the stabilization phase. These modules provide the drone with an ability to perform autonomous flip. Simulation and experimental tests on a Crazyflie quadrotor are successful. However, hardware performance is not consistent and in need of further works.</p> <hr> <p><span style="color:blue"> For more details, please check our report.</span></p> <div class="row justify-content-sm-center"> <div class="col-sm-6 mt-1 mt-md-0"> <iframe height="643" src="https://www.youtube.com/embed/81XYgRthhc0" title="YouTube video player" frameborder="0" style="border: 0px solid #bbb; border-radius: 10px; width: 100%;" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> </div> <div class="col-sm-6 mt-1 mt-md-0"> <iframe height="643" src="https://www.youtube.com/embed/y1OanjJ8mtQ" title="YouTube video player" frameborder="0" style="border: 0px solid #bbb; border-radius: 10px; width: 100%;" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> </div> </div> <div class="caption"> Left: LQR hovering <br> Right: Autonomous flip </div> <h2 id="introduction">Introduction</h2> <p>Aggressive maneuvers for drones have been a topic studied for a long time. The limited computing power and sensor inputs for a quadrotor make the task challenging and interesting. These were achieved mainly using classical controls and recent learning-based methods. Previous work <a href="https://www.uscamsl.com/Publications/Conference/ICRA2016.pdf" rel="external nofollow noopener" target="_blank">[html]</a> aims to perform single and multiple flips on a Crazyflie using two controllers and a time-dependent trajectory. They employ a cascaded PID controller for normal operations like hovering while it uses a PD-like controller while performing the flip. The trajectory function gives the angular velocities about the flipping axis based on the time inputted. The angular velocities across non-flipping axes are zeros. So the flipping controller takes the three angular velocities and their derivatives as input. The paper provided a simple yet powerful technique for drone flipping, but the parameters for trajectory and controllers in the entire paper were based on Crazyflie 1.0. This work is chosen as our base reference to develop a novel flipping pipeline in Crazyflie 2.1.</p> <h2 id="controller-design">Controller Design</h2> <p>This section is split into 3 main parts â€“ flipping trajectory planner, stabilizing controller design, and flipping controller design. The overall control architecture is designed to switch between the two controllers based on the time and reference trajectory. We plan to use the LQR controller during the normal flight and stabilization phase and the flipping controller during the flip stages of the trajectory.</p> <h3 id="flipping-trajectory-planner">Flipping Trajectory Planner</h3> <p>First, reference trajectory is defined to represent a flip in mathematical form. This is the reference trajectory the controllers need to track to perform the flip. The design of the trajectory needs to factor in the dynamics of the drone and the limitations of the hardware as well. The flip trajectory is defined in the form of angular speeds instead of angles. This has two benefits; namely, the trajectory can be designed to better account for the actuating limits of the drone, and also lower chances of stall.</p> <p>We split the complex maneuver of flip into five stages to for easier representation in mathematical forms and switch between them based on time. The primary three middle planning stages can be seen in the figure below.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/acsi/plan_flip.png" sizes="95vw"></source> <img src="/assets/acsi/plan_flip.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Title" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Generalized flipping speed reference in previous work </div> <p>The flipping planner outputs a trajectory for the quadrotor to follow. This is divided into five stages as follows:</p> <ul> <li>Ascent phase: Here the quadrotor is boosted to obtain moments and inertia before executing the flip.</li> <li>Increasing angular velocity phase: In this stage, the roll rate slowly increases from 0 to Ï‰max.</li> <li>Max angular velocity phase: At this stage the Ï‰max is commanded.</li> <li>Decreasing angular velocity phase: In this stage, the roll rate decreases from Ï‰max to 0.</li> <li>Stabilizing phase: This phase is activated after a complete flip. The quadrotor is stabilized and enters normal flight mode</li> </ul> <h3 id="flipping-controller">Flipping Controller</h3> <p>Following the previous work, a <a href="https://ctms.engin.umich.edu/CTMS/index.php?example=Introduction&amp;section=ControlPID" rel="external nofollow noopener" target="_blank">PD-like controller</a> is designed for tracking the angular velocity from the planner.</p> \[u(t) = k_p e(t) + k_d \dot{e}(t)\] <p>The PD controller can be tuned to obtain a desired behavior from the controller by varying the \(k_p\) and \(k_d\) terms. This controller provides the control efforts in the form of three torques, and a thrust is set as the droneâ€™s weight to maintain a constant height and not to saturate the actuators.</p> <h3 id="stabilizing-controller">Stabilizing Controller</h3> <p>An <a href="http://underactuated.mit.edu/lqr.html" rel="external nofollow noopener" target="_blank">LQR controller</a> is designed to re-stabilize the drone after a complete flip. It is noteworthy that we require a robust controller because initial errors for this controller can be significant. LQR controller is a full-state feedback controller and is designed using the linearized mathematical model of the quadrotor. An optimization problem is solved to obtain the gains of the LQR controller. The LQR controller is tuned by varying the \(Q\) and \(R\) matrices to get the desired performance from the controller.</p> <h2 id="results">Results</h2> <p>There are several testing cases for flipping maneuvers depending on open-loop vs. closed-loop planner, not tuned vs. tuned attitude rate PID, and PID vs. LQR stabilizer. Single flip is tested first with detailed analysis before moving to the more challenging cases. Please see our report for more details.</p> <div class="row justify-content-sm-center"> <div class="col-sm-12 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/acsi/flip_steps.png" sizes="95vw"></source> <img src="/assets/acsi/flip_steps.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Title" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Snapshots of our flipping maneuver from the demo video </div> <h2 id="conclusions">Conclusions</h2> <p>This work has provided a complete flipping maneuver pipeline which is very challenging for a micro quadrotorâ€™s acrobatic application. Our approach divides the process into three steps: ascent, flipping and re-stabilization. Following that, we developed a flipping planner, a flipping controller, and a stabilizing controller. An open-loop flipping planner will generate a three-stage attitude rate reference based on time, compared to the generalized flipping angle feedback of a closed-loop one. This planner must consider the limited sensing and actuating capacity of the quadrotor. To track that reference, we use a flipping controller, which has a PD-like architecture, then switch to a regular controller after completing a flip. For that re-stabilization phase, both cascaded PID and LQR controllers are considered. These modules are implemented via Python API as well as directly Crazyflie firmware. Finally, this paper has detailed experimental testing and demonstrated successful flip maneuvers. However, the majority of the tests witness failures due to many different factors, including communication delay, open-loop drawbacks, and not-robust-enough LQR controllers. Many modifications to the current pipeline can be made to improve the performance in the future. Firstly, the closed-loop planner, which needs more integration tests, has provided the stabilizing controller with good initial conditions. Secondly, all modules should be directly implemented in the on-board microprocessor, which will significantly help with the delay problem. Last but not least, more accurate state measurements and different architectures can boost the LQR stabilizerâ€™s robustness and overall performance.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 Khai Nguyen. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>